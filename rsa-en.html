<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Crext</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">


    <style>
        .dragbox {
            width: 400px;
            height: 150px;
            margin: auto;
            text-align: center;
            background-color: #ffffff;
            border: 2px solid #01293c;
            animation: progress-bar-stripes 1s linear infinite;
        }

        .progress-bar-striped {
            background-image: linear-gradient(45deg,
                    hsla(23, 100%, 50%, 0.15) 25%,
                    transparent 0,
                    transparent 50%,
                    hsla(0, 0%, 100%, 0.15) 0,
                    hsla(0, 0%, 100%, 0.15) 75%,
                    transparent 0,
                    transparent);
            background-size: 1rem 1rem;
        }

        .dragbox-over {
            background-color: #4cb9f9;
        }

        .text-vertical-center {
            position: relative;
            top: 50%;
            transform: translate(0, -50%);
        }
    </style>

</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top ">
        <div class="container d-flex align-items-center">

            <h1 class="logo me-auto"><a href="home.html">Crext</a></h1>
            <!-- Uncomment below if you prefer to use an image logo -->
            <!-- <a href="home.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link scrollto active" href="home.html">Home</a></li>
                    <li><a class="nav-link scrollto" href="#team">Team</a></li>
                    <li class="dropdown"><a href="#"><span>Algoritma</span> <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a href="aes-en.html">AES</a></li>
                            <li><a href="rsa-en.html">RSA</a></li>
                        </ul>
                    </li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav><!-- .navbar -->

        </div>
    </header><!-- End Header -->

    <!-- ======= Hero Section ======= -->
    
    <section id="hero" class="d-flex align-items-center">

        <div class="container">
            <div class="row">
                <div class="col-lg-6 d-flex flex-column justify-content-center pt-4 pt-lg-0 order-2 order-lg-1"
                    data-aos="fade-up" data-aos-delay="200">
                    <h1>Simulasi AES dan RSA</h1>
                    <h2>Website ini memiliki fitur simulasi algoritma kripgrafi modern AES dan RSA.
                        Simulasi algoritma dengan menggunakan file untuk di enkripsi dan dekripsi</h2>
                </div>
                <div class="col-lg-6 order-1 order-lg-2 presentation" data-aos="zoom-in" data-aos-delay="200">
                    <img src="assets/img/presentation.jpg" class="img-fluid animated" alt="">
                </div>
            </div>
        </div>

    </section><!-- End Hero -->

    <main id="main">

        <!-- ======= Why Us Section ======= -->
        <section id="why-us" class="why-us section-bg">

            <div class="container">
                <div class="row g-5 align-items-center">
                    <div class="col-lg-6 wow zoomIn" data-wow-delay="0.1s">
                        <img class="img-fluid" src="assets/img/RSA.png">
                    </div>
                    <div class="col-lg-6 wow fadeInUp" data-wow-delay="0.1s">
                        <h2 class="mb-4">RSA (Rivest—Shamir—Adleman)</h2>
                        <p class="mb-4">SA adalah algoritma enkripsi yang digunakan untuk mengenkripsi data dan
                            mendekripsinya
                            dengan kunci rahasia.
                            RSA merupakan salah satu algoritma enkripsi asimetris yang paling umum digunakan, dimana
                            kunci enkripsi
                            yang digunakan dan kunci dekripsi berbeda.
                            RSA dikembangkan pada tahun 1978 oleh Ron Rivest, Adi Shamir dan Leonard Adleman, yang
                            memberi nama
                            algoritma tersebut.
                            RSA menggunakan prinsip enkripsi berdasarkan teori prima, dimana kunci enkripsi yang
                            digunakan terdiri
                            dari dua bilangan prima besar.
                            Algoritma ini sering digunakan dalam aplikasi keamanan jaringan, termasuk sistem pembayaran
                            online dan
                            komunikasi elektronik.
                        </p>
                        <div class="row g-3 mb-4">
                            <div class="col-12 d-flex">
                                <div class="flex-shrink-0 btn-lg-square rounded-circle bg-primary">
                                    <i class="fa fa-user-tie text-white"></i>
                                </div>
                                <div class="ms-4">
                                    <h6>Enkripsi</h6>
                                    <span>Proses perubahan plaintext (kata yang bisa dibaca) menjadi ciphertext (kata
                                        yang tidak bisa
                                        dibaca)</span>
                                </div>
                            </div>
                            <div class="col-12 d-flex">
                                <div class="flex-shrink-0 btn-lg-square rounded-circle bg-primary">
                                    <i class="fa fa-chart-line text-white"></i>
                                </div>
                                <div class="ms-4">
                                    <h6>Dekripsi</h6>
                                    <span>Proses perubahan ciphertext menjadi sebuah plaintext</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- About End -->
            </div>

            <div class="container">
                
                    <div class="card card-body">

                        <!--<div class="row p-5 border mt-4">
                            <h2 class="col-12 text-center pb-3">Simulasi RSA</h2>
                            <label>Kunci Publik</label>
                            <textarea id="pub" rows="5" class="col-12" readonly></textarea>
                            <label>Kunci Privat</label>
                            <textarea id="pri" rows="5" class="col-12" readonly></textarea>
                            <div class="col-12 text-center mt-3 mb-3">
                                <button class="btn btn-secondary" onclick="getRsaKeys()">
                                    Refresh Kunci
                                </button>
                            </div>
                        </div>-->
                        <div class="row p-5 border mt-4">
                            <h2 class="col-12 text-center pb-5">
                                Plaintext Encrypts dan Decrypts RSA
                            </h2>
                            <label>Plaintext </label>
                            <textarea class="col-12" rows="1" id="plainText"></textarea>
                            <div class="col-12 text-center mt-3 mb-3">
                                <button class="btn btn-info" onclick="encryptRSA()">
                                    Encrypts
                                </button>
                            </div>
                            <label>Encrypts Text </label>
                            <textarea class="col-12" rows="3" id="encryptedText"></textarea>
                            <div class="col-12 text-center mt-3">
                                <button class="btn btn-warning" onclick="decryptRSA()">
                                    Decrypts
                                </button>
                            </div>
                            <label>Decrypts Text</label>
                            <textarea class="col-12" rows="1" id="decryptedText"></textarea>
                        </div>
                        <div class="row p-5 border mt-4">
                            
                            <h2 class="col-12 text-center pb-3">
                                Encrypts File RSA
                            </h2>
                            <div class="dragbox mt-2 mb-4 text-center" id="encryptionDropBox">
                                <p class="text-vertical-center">
                                    <strong>Drag File Disini Untuk Encrypts</strong>
                                </p>
                            </div>
                            <br>
                            <h2 class="col-12 text-center pb-3">
                                Decrypts File RSA
                            </h2>
                            <div class="dragbox mt-2 text-center" id="decryptionDropBox">
                                <p class="text-vertical-center">
                                    <strong>Drag File Disini Untuk Decrypts</strong>
                                </p>
                            </div>
                            
                        </div>

                    </div>
                </div>
            </div>

        </section>
        <!-- End Why Us Section -->


    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">

        <div class="footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-3 col-md-6 footer-contact">
                        <h3>Crext</h3>
                        <p>
                            Jl. Umban Sari <br>
                            Rumbai<br>
                            Indonesia <br><br>
                            <strong>Phone:</strong> +62 813 1234 5678<br>
                            <strong>Email:</strong> crext@gmail.com<br>
                        </p>
                    </div>

                    <div class="col-lg-3 col-md-6 footer-links">
                        <h4>Useful Links</h4>
                        <ul>
                            <li><i class="bx bx-chevron-right"></i> <a href="home.html">Home</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="aes.html">AES</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="rsa.html">RSA</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-3 col-md-6 footer-links">
                        <h4>Our Social Networks</h4>
                        <div class="social-links mt-3">
                            <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                            <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                            <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                            <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                            <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="container footer-bottom clearfix">
            <div class="copyright">
                &copy; Copyright <strong><span>Crext</span></strong>. All Rights Reserved
            </div>
            <div class="credits">
                <!-- All the links in the footer should remain intact. -->
                <!-- You can delete the links only if you purchased the pro version. -->
                <!-- Licensing information: https://bootstrapmade.com/license/ -->
                <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/arsha-free-bootstrap-html-template-corporate/ -->
            </div>
        </div>
    </footer><!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.0.0-rc.1/jsencrypt.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

    <script>
        var publicKey = "";
        var privateKey = "";

        window.onload = () => {
            getRsaKeys();
        };

        $("#encryptionDropBox").on("dragover", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).addClass("dragbox-over");
        });
        $("#encryptionDropBox").on("dragleave", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).removeClass("dragbox-over");
        });
        $("#encryptionDropBox").on("drop", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).addClass("progress-bar-striped");
            var file = evt.originalEvent.dataTransfer.files[0];
            setTimeout(async () => {
                await fileEncryptRSA(file);
                $(this).removeClass("progress-bar-striped");
                $(this).removeClass("dragbox-over");
            }, 1000);
        });
        $("#decryptionDropBox").on("dragover", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).addClass("dragbox-over");
        });
        $("#decryptionDropBox").on("dragleave", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).removeClass("dragbox-over");
        });
        $("#decryptionDropBox").on("drop", function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            $(this).addClass("progress-bar-striped");
            var file = evt.originalEvent.dataTransfer.files[0];
            setTimeout(async () => {
                await fileDecryptRSA(file);
                $(this).removeClass("progress-bar-striped");
                $(this).removeClass("dragbox-over");
            }, 1000);
        });
        //plainText encryption (max = 117)
        function encryptRSA(data) {
            if (data === undefined) {
                data = $("#plainText").val();
            }
            var encrypt = new JSEncrypt();
            encrypt.setPublicKey(publicKey);
            var result =
                encrypt.encrypt(data) == null ? "Failed" : encrypt.encrypt(data);
            document.getElementById("encryptedText").value = result;
            return result;
        }
        //plainText decryption (max = 172)
        function decryptRSA(data) {
            if (data === undefined) {
                data = $("#encryptedText").val();
            }
            var decrypt = new JSEncrypt();
            decrypt.setPrivateKey(privateKey);
            var result =
                decrypt.decrypt(data) == null ? "Failed" : decrypt.decrypt(data);
            document.getElementById("decryptedText").value = result;
            return result;
        }

        //read file in 10 based which convert from 8 bits binary, then encrypt the bytecode
        function fileEncryptRSA(file) {
            var filename = file.name;
            var reader = new FileReader();
            reader.readAsArrayBuffer(file);
            reader.onload = function (evt) {
                if (evt.target.readyState == FileReader.DONE) {
                    var arrayBuffer = evt.target.result;
                    var arrayString = new Uint8Array(arrayBuffer).toString();
                    var encrypt = new JSEncrypt();
                    encrypt.setPublicKey(document.getElementById("pub").value);
                    var maxLength = 117;
                    var count =
                        Math.ceil(arrayString.length / maxLength) > 0 ?
                        Math.ceil(arrayString.length / maxLength) :
                        1;
                    var encryptedData = "";
                    for (let i = 0; i < count; i++) {
                        var temp = "";
                        for (
                            let ii = i * maxLength; ii < (i + 1) * maxLength && ii < arrayString.length; ii++
                        ) {
                            temp += arrayString[ii];
                        }
                        encryptedData += encrypt.encrypt(temp);
                    }
                    downFlie(encryptedData, "encrypted." + filename + ".sc.encrypt");
                }
            };
        }

        //read file in 10 based which convert from 8 bits binary, then decrypt the encrypted text
        function fileDecryptRSA(file) {
            var filename = file.name;
            var reader = new FileReader();
            reader.readAsArrayBuffer(file);
            reader.onload = function (evt) {
                if (evt.target.readyState == FileReader.DONE) {
                    var arrayBuffer = evt.target.result;
                    var array = new Uint8Array(arrayBuffer);
                    var decrypt = new JSEncrypt();
                    decrypt.setPrivateKey(document.getElementById("pri").value);
                    var maxBufferLength = 172;
                    var count =
                        Math.ceil(array.length / maxBufferLength) > 0 ?
                        Math.ceil(array.length / maxBufferLength) :
                        1;
                    var decryptedBin = "";
                    for (var i = 0; i < count; i++) {
                        var temp = "";
                        for (
                            var ii = i * maxBufferLength; ii < (i + 1) * maxBufferLength && ii < array.length; ii++
                        ) {
                            temp += String.fromCharCode(array[ii]);
                        }
                        decryptedBin += decrypt.decrypt(temp); //10 base numbers for each byte
                    }

                    decryptedBin = decryptedBin.split(",");
                    var decryptedData = [];
                    decryptedBin.forEach((element) => {
                        decryptedData.push(parseInt(element));
                    });
                    decryptedData = new Uint8Array(decryptedData);
                    downFlie(
                        decryptedData.buffer,
                        "decrypted." +
                        filename.replace("encrypted.", "").replace(".sc.encrypt", "")
                    );
                }
            };
        }

        //download file
        function downFlie(buffer, filename) {
            var elementA = document.createElement("a");
            elementA.download = filename;
            elementA.style.display = "none";
            try {
                var file = new Blob([buffer]);
                elementA.href = URL.createObjectURL(file);
                document.body.appendChild(elementA);
                elementA.click();
                document.body.removeChild(elementA);
            } catch (e) {
                console.log(e);
            }
        }
    </script>
    <script>
        function getRsaKeys(func) {
            window.crypto.subtle
                .generateKey({
                        name: "RSA-OAEP",
                        modulusLength: 1024, //can be 1024, 2048, or 4096
                        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
                        hash: {
                            name: "SHA-512"
                        }, //can be "SHA-1", "SHA-256", "SHA-384", or "SHA-512"
                    },
                    true, //whether the key is extractable (i.e. can be used in exportKey)
                    ["encrypt", "decrypt"] //must be ["encrypt", "decrypt"] or ["wrapKey", "unwrapKey"]
                )
                .then(function (key) {
                    window.crypto.subtle
                        .exportKey("pkcs8", key.privateKey)
                        .then(function (priKeyBuffer) {
                            window.crypto.subtle
                                .exportKey("spki", key.publicKey)
                                .then(function (pubKeyBuffer) {
                                    privateKey = RSA2text(priKeyBuffer, 1);
                                    publicKey = RSA2text(pubKeyBuffer);
                                    document.getElementById("pub").value = publicKey;
                                    document.getElementById("pri").value = privateKey;
                                })
                                .catch(function (err) {
                                    console.log(err);
                                });
                        })
                        .catch(function (err) {
                            console.log(err);
                        });
                })
                .catch(function (err) {
                    console.log(err);
                });
        }

        function RSA2text(buffer, isPrivate = 0) {
            var binary = "";
            var bytes = new Uint8Array(buffer);
            var len = bytes.byteLength;
            for (var i = 0; i < len; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            var base64 = window.btoa(binary);
            var text =
                "-----BEGIN " + (isPrivate ? "PRIVATE" : "PUBLIC") + " KEY-----\n";
            text += base64
                .replace(/[^\x00-\xff]/g, "$&\x01")
                .replace(/.{64}\x01?/g, "$&\n");
            text += "\n-----END " + (isPrivate ? "PRIVATE" : "PUBLIC") + " KEY-----";
            return text;
        }
    </script>

</body>

</html>